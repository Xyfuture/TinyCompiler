# DSL

> 本次的编译器采用基于python的DSL作为基础的编程语言。这个思路与spinalhdl比较相似，借助python提供的AST，通过自己实现的类，并重载一系列的运算符实现DSL中不同数据类型之间的操作。同时借助python的栈实现DSL中栈的创建与销毁

## MatrixVar



## VectorVar

> 数据在逻辑上是连续的，只能是一维数组，不能是多维的

DSL中的vector类型变量，该变量拥有一块内存空间和，并拥有存储该内存空间地址和内存大小的寄存器。

这个地址空间可能是共享的，多个变量（VectorVar，TensorVar）等可以使用同一个内存空间或者包含关系，但是那两个寄存器id是唯一的，两个变量共享一段内存，但是每个变量都有自己的寄存器id。

变量是相对固定的，也就是说一旦分配了内存空间，这个空间是不会变的，同理那两个寄存器也是不会变的。

VectorVar可以自建创建内存空间，这个时候内存是属于自己的，自己销毁时要释放栈内存。但是有部分也是派生出来的，内存不是自己独占的(共享)，这样的变量仅拥有自己两个寄存器，析构函数中不释放内存。

## TensorVar

这个是一个扩展版的VectorVar。VectorVar限制了数据必须是一维的数组，但是TensorVar可以表示高维数据，虽然在底层数据还是按照一维展开的形式存储的（参考cpp的数据展开逻辑）。TensorVar提供了一些方便高维数据操作的方法

同时实现TensorVar和VectorVar主要是为了区分。所有的算数运算理论上应该只能由VectorVar操作，TensorVar在参与运算前应该提前转换为VectorVar	

